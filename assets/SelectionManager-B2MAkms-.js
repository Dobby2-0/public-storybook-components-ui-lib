import{r as v,R}from"./index-CTjT7uj6.js";import{r as he}from"./index-9r8iugjR.js";import{a as ye,$ as pe}from"./FocusScope-DkCrxc-x.js";import{j as ve,b as be,d as N,M as ge,C as $e,n as Q,N as ee,H as te}from"./useFocusRing-COlWfXo5.js";import{b as me,$ as ue,c as fe,d as Se}from"./usePress-txE9COHB.js";import{$ as Ke}from"./context-Ao51U0H-.js";import{$ as xe}from"./useControlledState-CEg4Rl-x.js";function we(i,e){const t=[];for(;i&&i!==document.documentElement;)ye(i,e)&&t.push(i),i=i.parentElement;return t}let Pe=0;const X=new Map;function Fe(i){let[e,t]=v.useState();return ve(()=>{if(!i)return;let l=X.get(i);if(l)t(l.element.id);else{let s=`react-aria-description-${Pe++}`;t(s);let n=document.createElement("div");n.id=s,n.style.display="none",n.textContent=i,document.body.appendChild(n),l={refCount:0,element:n},X.set(i,l)}return l.refCount++,()=>{l&&--l.refCount===0&&(l.element.remove(),X.delete(i))}},[i]),{"aria-describedby":i?e:void 0}}function le(i,e,t,l){let s=be(t),n=t==null;v.useEffect(()=>{if(n||!i.current)return;let o=i.current;return o.addEventListener(e,s,l),()=>{o.removeEventListener(e,s,l)}},[i,e,l,n,s])}function de(i,e){let t=ie(i,e,"left"),l=ie(i,e,"top"),s=e.offsetWidth,n=e.offsetHeight,o=i.scrollLeft,f=i.scrollTop,{borderTopWidth:a,borderLeftWidth:p}=getComputedStyle(i),y=i.scrollLeft+parseInt(p,10),g=i.scrollTop+parseInt(a,10),d=y+i.clientWidth,h=g+i.clientHeight;t<=o?o=t-parseInt(p,10):t+s>d&&(o+=t+s-d),l<=g?f=l-parseInt(a,10):l+n>h&&(f+=l+n-h),i.scrollLeft=o,i.scrollTop=f}function ie(i,e,t){const l=t==="left"?"offsetLeft":"offsetTop";let s=0;for(;e.offsetParent&&(s+=e[l],e.offsetParent!==i);){if(e.offsetParent.contains(i)){s-=i[l];break}e=e.offsetParent}return s}function se(i,e){if(document.contains(i)){let o=document.scrollingElement||document.documentElement;if(window.getComputedStyle(o).overflow==="hidden"){let a=we(i);for(let p of a)de(p,i)}else{var t;let{left:a,top:p}=i.getBoundingClientRect();i==null||(t=i.scrollIntoView)===null||t===void 0||t.call(i,{block:"nearest"});let{left:y,top:g}=i.getBoundingClientRect();if(Math.abs(a-y)>1||Math.abs(p-g)>1){var l,s,n;e==null||(s=e.containingElement)===null||s===void 0||(l=s.scrollIntoView)===null||l===void 0||l.call(s,{block:"center",inline:"center"}),(n=i.scrollIntoView)===null||n===void 0||n.call(i,{block:"nearest"})}}}}const De=500;function Te(i){let{isDisabled:e,onLongPressStart:t,onLongPressEnd:l,onLongPress:s,threshold:n=De,accessibilityDescription:o}=i;const f=v.useRef(void 0);let{addGlobalListener:a,removeGlobalListener:p}=me(),{pressProps:y}=ue({isDisabled:e,onPressStart(d){if(d.continuePropagation(),(d.pointerType==="mouse"||d.pointerType==="touch")&&(t&&t({...d,type:"longpressstart"}),f.current=setTimeout(()=>{d.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),s&&s({...d,type:"longpress"}),f.current=void 0},n),d.pointerType==="touch")){let h=F=>{F.preventDefault()};a(d.target,"contextmenu",h,{once:!0}),a(window,"pointerup",()=>{setTimeout(()=>{p(d.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(d){f.current&&clearTimeout(f.current),l&&(d.pointerType==="mouse"||d.pointerType==="touch")&&l({...d,type:"longpressend"})}}),g=Fe(s&&!e?o:void 0);return{longPressProps:N(y,g)}}function V(i){return ge()?i.altKey:i.ctrlKey}function U(i){return $e()?i.metaKey:i.ctrlKey}const Ie=1e3;function ke(i){let{keyboardDelegate:e,selectionManager:t,onTypeSelect:l}=i,s=v.useRef({search:"",timeout:null}).current,n=o=>{let f=Ae(o.key);if(!f||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target))return;f===" "&&s.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),s.search+=f;let a=e.getKeyForSearch(s.search,t.focusedKey);a==null&&(a=e.getKeyForSearch(s.search)),a!=null&&(t.setFocusedKey(a),l&&l(a)),clearTimeout(s.timeout),s.timeout=setTimeout(()=>{s.search=""},Ie)};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?n:null}}}function Ae(i){return i.length===1||!/^[A-Z]/i.test(i)?i:""}function Ge(i){let{selectionManager:e,keyboardDelegate:t,ref:l,autoFocus:s=!1,shouldFocusWrap:n=!1,disallowEmptySelection:o=!1,disallowSelectAll:f=!1,selectOnFocus:a=e.selectionBehavior==="replace",disallowTypeAhead:p=!1,shouldUseVirtualFocus:y,allowsTabNavigation:g=!1,isVirtualized:d,scrollRef:h=l,linkBehavior:F="action"}=i,{direction:x}=Ke(),b=fe(),D=r=>{if(r.altKey&&r.key==="Tab"&&r.preventDefault(),!l.current.contains(r.target))return;const $=(u,B)=>{if(u!=null){if(e.isLink(u)&&F==="selection"&&a&&!V(r)){he.flushSync(()=>{e.setFocusedKey(u,B)});let O=h.current.querySelector(`[data-key="${CSS.escape(u.toString())}"]`),_=e.getItemProps(u);b.open(O,r,_.href,_.routerOptions);return}if(e.setFocusedKey(u,B),e.isLink(u)&&F==="override")return;r.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(u):a&&!V(r)&&e.replaceSelection(u)}};switch(r.key){case"ArrowDown":if(t.getKeyBelow){var w,K,k;let u=e.focusedKey!=null?(w=t.getKeyBelow)===null||w===void 0?void 0:w.call(t,e.focusedKey):(K=t.getFirstKey)===null||K===void 0?void 0:K.call(t);u==null&&n&&(u=(k=t.getFirstKey)===null||k===void 0?void 0:k.call(t,e.focusedKey)),u!=null&&(r.preventDefault(),$(u))}break;case"ArrowUp":if(t.getKeyAbove){var A,z,c;let u=e.focusedKey!=null?(A=t.getKeyAbove)===null||A===void 0?void 0:A.call(t,e.focusedKey):(z=t.getLastKey)===null||z===void 0?void 0:z.call(t);u==null&&n&&(u=(c=t.getLastKey)===null||c===void 0?void 0:c.call(t,e.focusedKey)),u!=null&&(r.preventDefault(),$(u))}break;case"ArrowLeft":if(t.getKeyLeftOf){var C,H,j;let u=(C=t.getKeyLeftOf)===null||C===void 0?void 0:C.call(t,e.focusedKey);u==null&&n&&(u=x==="rtl"?(H=t.getFirstKey)===null||H===void 0?void 0:H.call(t,e.focusedKey):(j=t.getLastKey)===null||j===void 0?void 0:j.call(t,e.focusedKey)),u!=null&&(r.preventDefault(),$(u,x==="rtl"?"first":"last"))}break;case"ArrowRight":if(t.getKeyRightOf){var q,G,Y;let u=(q=t.getKeyRightOf)===null||q===void 0?void 0:q.call(t,e.focusedKey);u==null&&n&&(u=x==="rtl"?(G=t.getLastKey)===null||G===void 0?void 0:G.call(t,e.focusedKey):(Y=t.getFirstKey)===null||Y===void 0?void 0:Y.call(t,e.focusedKey)),u!=null&&(r.preventDefault(),$(u,x==="rtl"?"last":"first"))}break;case"Home":if(t.getFirstKey){r.preventDefault();let u=t.getFirstKey(e.focusedKey,U(r));e.setFocusedKey(u),U(r)&&r.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(u):a&&e.replaceSelection(u)}break;case"End":if(t.getLastKey){r.preventDefault();let u=t.getLastKey(e.focusedKey,U(r));e.setFocusedKey(u),U(r)&&r.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(u):a&&e.replaceSelection(u)}break;case"PageDown":if(t.getKeyPageBelow){let u=t.getKeyPageBelow(e.focusedKey);u!=null&&(r.preventDefault(),$(u))}break;case"PageUp":if(t.getKeyPageAbove){let u=t.getKeyPageAbove(e.focusedKey);u!=null&&(r.preventDefault(),$(u))}break;case"a":U(r)&&e.selectionMode==="multiple"&&f!==!0&&(r.preventDefault(),e.selectAll());break;case"Escape":!o&&e.selectedKeys.size!==0&&(r.stopPropagation(),r.preventDefault(),e.clearSelection());break;case"Tab":if(!g){if(r.shiftKey)l.current.focus();else{let u=pe(l.current,{tabbable:!0}),B,O;do O=u.lastChild(),O&&(B=O);while(O);B&&!B.contains(document.activeElement)&&te(B)}break}}},m=v.useRef({top:0,left:0});le(h,"scroll",d?null:()=>{m.current={top:h.current.scrollTop,left:h.current.scrollLeft}});let S=r=>{if(e.isFocused){r.currentTarget.contains(r.target)||e.setFocused(!1);return}if(r.currentTarget.contains(r.target)){if(e.setFocused(!0),e.focusedKey==null){let K=A=>{A!=null&&(e.setFocusedKey(A),a&&e.replaceSelection(A))},k=r.relatedTarget;var $,w;k&&r.currentTarget.compareDocumentPosition(k)&Node.DOCUMENT_POSITION_FOLLOWING?K(($=e.lastSelectedKey)!==null&&$!==void 0?$:t.getLastKey()):K((w=e.firstSelectedKey)!==null&&w!==void 0?w:t.getFirstKey())}else d||(h.current.scrollTop=m.current.top,h.current.scrollLeft=m.current.left);if(e.focusedKey!=null){let K=h.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);K&&(K.contains(document.activeElement)||te(K),ee()==="keyboard"&&se(K,{containingElement:l.current}))}}},T=r=>{r.currentTarget.contains(r.relatedTarget)||e.setFocused(!1)};const I=v.useRef(s);v.useEffect(()=>{if(I.current){let r=null;s==="first"&&(r=t.getFirstKey()),s==="last"&&(r=t.getLastKey());let $=e.selectedKeys;if($.size){for(let w of $)if(e.canSelectItem(w)){r=w;break}}e.setFocused(!0),e.setFocusedKey(r),r==null&&!y&&Q(l.current)}},[]);let E=v.useRef(e.focusedKey);v.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==E.current||I.current)&&(h!=null&&h.current)){let r=ee(),$=l.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);if(!$)return;(r==="keyboard"||I.current)&&(de(h.current,$),r!=="virtual"&&se($,{containingElement:l.current}))}!y&&e.isFocused&&e.focusedKey==null&&E.current!=null&&Q(l.current),E.current=e.focusedKey,I.current=!1}),le(l,"react-aria-focus-scope-restore",r=>{r.preventDefault(),e.setFocused(!0)});let M={onKeyDown:D,onFocus:S,onBlur:T,onMouseDown(r){h.current===r.target&&r.preventDefault()}},{typeSelectProps:W}=ke({keyboardDelegate:t,selectionManager:e});p||(M=N(W,M));let L;return y||(L=e.focusedKey==null?0:-1),{collectionProps:{...M,tabIndex:L}}}function Ye(i){let{selectionManager:e,key:t,ref:l,shouldSelectOnPressUp:s,shouldUseVirtualFocus:n,focus:o,isDisabled:f,onAction:a,allowsDifferentPressOrigin:p,linkBehavior:y="action"}=i,g=fe(),d=c=>{if(c.pointerType==="keyboard"&&V(c))e.toggleSelection(t);else{if(e.selectionMode==="none")return;if(e.isLink(t)){if(y==="selection"){let C=e.getItemProps(t);g.open(l.current,c,C.href,C.routerOptions),e.setSelectedKeys(e.selectedKeys);return}else if(y==="override"||y==="none")return}e.selectionMode==="single"?e.isSelected(t)&&!e.disallowEmptySelection?e.toggleSelection(t):e.replaceSelection(t):c&&c.shiftKey?e.extendSelection(t):e.selectionBehavior==="toggle"||c&&(U(c)||c.pointerType==="touch"||c.pointerType==="virtual")?e.toggleSelection(t):e.replaceSelection(t)}};v.useEffect(()=>{t===e.focusedKey&&e.isFocused&&!n&&(o?o():document.activeElement!==l.current&&Q(l.current))},[l,t,e.focusedKey,e.childFocusStrategy,e.isFocused,n]),f=f||e.isDisabled(t);let h={};!n&&!f?h={tabIndex:t===e.focusedKey?0:-1,onFocus(c){c.target===l.current&&e.setFocusedKey(t)}}:f&&(h.onMouseDown=c=>{c.preventDefault()});let F=e.isLink(t)&&y==="override",x=e.isLink(t)&&y!=="selection"&&y!=="none",b=!f&&e.canSelectItem(t)&&!F,D=(a||x)&&!f,m=D&&(e.selectionBehavior==="replace"?!b:!b||e.isEmpty),S=D&&b&&e.selectionBehavior==="replace",T=m||S,I=v.useRef(null),E=T&&b,M=v.useRef(!1),W=v.useRef(!1),L=c=>{if(a&&a(),x){let C=e.getItemProps(t);g.open(l.current,c,C.href,C.routerOptions)}},r={};s?(r.onPressStart=c=>{I.current=c.pointerType,M.current=E,c.pointerType==="keyboard"&&(!T||re())&&d(c)},p?(r.onPressUp=m?null:c=>{c.pointerType!=="keyboard"&&b&&d(c)},r.onPress=m?L:null):r.onPress=c=>{if(m||S&&c.pointerType!=="mouse"){if(c.pointerType==="keyboard"&&!ne())return;L(c)}else c.pointerType!=="keyboard"&&b&&d(c)}):(r.onPressStart=c=>{I.current=c.pointerType,M.current=E,W.current=m,b&&(c.pointerType==="mouse"&&!m||c.pointerType==="keyboard"&&(!D||re()))&&d(c)},r.onPress=c=>{(c.pointerType==="touch"||c.pointerType==="pen"||c.pointerType==="virtual"||c.pointerType==="keyboard"&&T&&ne()||c.pointerType==="mouse"&&W.current)&&(T?L(c):b&&d(c))}),h["data-key"]=t,r.preventFocusOnPress=n;let{pressProps:$,isPressed:w}=ue(r),K=S?c=>{I.current==="mouse"&&(c.stopPropagation(),c.preventDefault(),L(c))}:void 0,{longPressProps:k}=Te({isDisabled:!E,onLongPress(c){c.pointerType==="touch"&&(d(c),e.setSelectionBehavior("toggle"))}}),A=c=>{I.current==="touch"&&M.current&&c.preventDefault()},z=e.isLink(t)?c=>{Se.isOpening||c.preventDefault()}:void 0;return{itemProps:N(h,b||m?$:{},E?k:{},{onDoubleClick:K,onDragStartCapture:A,onClick:z}),isPressed:w,isSelected:e.isSelected(t),isFocused:e.isFocused&&e.focusedKey===t,isDisabled:f,allowsSelection:b,hasAction:T}}function ne(){let i=window.event;return(i==null?void 0:i.key)==="Enter"}function re(){let i=window.event;return(i==null?void 0:i.key)===" "||(i==null?void 0:i.code)==="Space"}class Ce{build(e,t){return this.context=t,oe(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:l}=e;if(R.isValidElement(t)&&t.type===R.Fragment)yield*this.iterateCollection({children:t.props.children,items:l});else if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");for(let s of e.items)yield*this.getFullNode({value:s},{renderer:t})}else{let s=[];R.Children.forEach(t,o=>{s.push(o)});let n=0;for(let o of s){let f=this.getFullNode({element:o,index:n},{});for(let a of f)n++,yield a}}}getKey(e,t,l,s){if(e.key!=null)return e.key;if(t.type==="cell"&&t.key!=null)return`${s}${t.key}`;let n=t.value;if(n!=null){var o;let f=(o=n.key)!==null&&o!==void 0?o:n.id;if(f==null)throw new Error("No key found for item");return f}return s?`${s}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,l,s){if(R.isValidElement(e.element)&&e.element.type===R.Fragment){let a=[];R.Children.forEach(e.element.props.children,y=>{a.push(y)});let p=e.index;for(const y of a)yield*this.getFullNode({element:y,index:p++},t,l,s);return}let n=e.element;if(!n&&e.value&&t&&t.renderer){let a=this.cache.get(e.value);if(a&&(!a.shouldInvalidate||!a.shouldInvalidate(this.context))){a.index=e.index,a.parentKey=s?s.key:null,yield a;return}n=t.renderer(e.value)}if(R.isValidElement(n)){let a=n.type;if(typeof a!="function"&&typeof a.getCollectionNode!="function"){let d=typeof n.type=="function"?n.type.name:n.type;throw new Error(`Unknown element <${d}> in collection.`)}let p=a.getCollectionNode(n.props,this.context),y=e.index,g=p.next();for(;!g.done&&g.value;){let d=g.value;e.index=y;let h=d.key;h||(h=d.element?null:this.getKey(n,e,t,l));let x=[...this.getFullNode({...d,key:h,index:y,wrapper:Ee(e.wrapper,d.wrapper)},this.getChildState(t,d),l?`${l}${n.key}`:n.key,s)];for(let b of x){if(b.value=d.value||e.value,b.value&&this.cache.set(b.value,b),e.type&&b.type!==e.type)throw new Error(`Unsupported type <${Z(b.type)}> in <${Z(s.type)}>. Only <${Z(e.type)}> is supported.`);y++,yield b}g=p.next(x)}return}if(e.key==null)return;let o=this,f={type:e.type,props:e.props,key:e.key,parentKey:s?s.key:null,value:e.value,level:s?s.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:oe(function*(){if(!e.hasChildNodes)return;let a=0;for(let p of e.childNodes()){p.key!=null&&(p.key=`${f.key}${p.key}`),p.index=a;let y=o.getFullNode(p,o.getChildState(t,p),f.key,f);for(let g of y)a++,yield g}})};yield f}constructor(){this.cache=new WeakMap}}function oe(i){let e=[],t=null;return{*[Symbol.iterator](){for(let l of e)yield l;t||(t=i());for(let l of t)e.push(l),yield l}}}function Ee(i,e){if(i&&e)return t=>i(e(t));if(i)return i;if(e)return e}function Z(i){return i[0].toUpperCase()+i.slice(1)}function Xe(i,e,t){let l=v.useMemo(()=>new Ce,[]),{children:s,items:n,collection:o}=i;return v.useMemo(()=>{if(o)return o;let a=l.build({children:s,items:n},t);return e(a)},[l,s,n,o,t,e])}function Me(i,e){return typeof e.getChildren=="function"?e.getChildren(i.key):i.childNodes}function Le(i){return Be(i,0)}function Be(i,e){if(e<0)return;let t=0;for(let l of i){if(t===e)return l;t++}}function Ze(i){let e;for(let t of i)e=t;return e}function J(i,e,t){if(e.parentKey===t.parentKey)return e.index-t.index;let l=[...ce(i,e),e],s=[...ce(i,t),t],n=l.slice(0,s.length).findIndex((o,f)=>o!==s[f]);return n!==-1?(e=l[n],t=s[n],e.index-t.index):l.findIndex(o=>o===t)>=0?1:(s.findIndex(o=>o===e)>=0,-1)}function ce(i,e){let t=[];for(;(e==null?void 0:e.parentKey)!=null;)e=i.getItem(e.parentKey),t.unshift(e);return t}class P extends Set{constructor(e,t,l){super(e),e instanceof P?(this.anchorKey=t??e.anchorKey,this.currentKey=l??e.currentKey):(this.anchorKey=t,this.currentKey=l)}}function Re(i,e){if(i.size!==e.size)return!1;for(let t of i)if(!e.has(t))return!1;return!0}function Je(i){let{selectionMode:e="none",disallowEmptySelection:t,allowDuplicateSelectionEvents:l,selectionBehavior:s="toggle",disabledBehavior:n="all"}=i,o=v.useRef(!1),[,f]=v.useState(!1),a=v.useRef(null),p=v.useRef(null),[,y]=v.useState(null),g=v.useMemo(()=>ae(i.selectedKeys),[i.selectedKeys]),d=v.useMemo(()=>ae(i.defaultSelectedKeys,new P),[i.defaultSelectedKeys]),[h,F]=xe(g,d,i.onSelectionChange),x=v.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),[b,D]=v.useState(s);s==="replace"&&b==="toggle"&&typeof h=="object"&&h.size===0&&D("replace");let m=v.useRef(s);return v.useEffect(()=>{s!==m.current&&(D(s),m.current=s)},[s]),{selectionMode:e,disallowEmptySelection:t,selectionBehavior:b,setSelectionBehavior:D,get isFocused(){return o.current},setFocused(S){o.current=S,f(S)},get focusedKey(){return a.current},get childFocusStrategy(){return p.current},setFocusedKey(S,T="first"){a.current=S,p.current=T,y(S)},selectedKeys:h,setSelectedKeys(S){(l||!Re(S,h))&&F(S)},disabledKeys:x,disabledBehavior:n}}function ae(i,e){return i?i==="all"?"all":new P(i):e}class Qe{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){return this.state.selectionMode==="none"?!1:(e=this.getKey(e),this.state.selectedKeys==="all"?this.canSelectItem(e):this.state.selectedKeys.has(e))}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(l=>t.has(l)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!e||l&&J(this.collection,l,e)<0)&&(e=l)}return e==null?void 0:e.key}get lastSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!e||l&&J(this.collection,l,e)>0)&&(e=l)}return e==null?void 0:e.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}e=this.getKey(e);let t;if(this.state.selectedKeys==="all")t=new P([e],e,e);else{let n=this.state.selectedKeys;var l;let o=(l=n.anchorKey)!==null&&l!==void 0?l:e;t=new P(n,o,e);var s;for(let f of this.getKeyRange(o,(s=n.currentKey)!==null&&s!==void 0?s:e))t.delete(f);for(let f of this.getKeyRange(e,o))this.canSelectItem(f)&&t.add(f)}this.state.setSelectedKeys(t)}getKeyRange(e,t){let l=this.collection.getItem(e),s=this.collection.getItem(t);return l&&s?J(this.collection,l,s)<=0?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){var l;if(!((l=this.layoutDelegate)===null||l===void 0)&&l.getKeyRange)return this.layoutDelegate.getKeyRange(e,t);let s=[],n=e;for(;n!=null;){let o=this.collection.getItem(n);if((o&&o.type==="item"||o.type==="cell"&&this.allowsCellSelection)&&s.push(n),n===t)return s;n=this.collection.getKeyAfter(n)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||t.type==="cell"&&this.allowsCellSelection)return e;for(;t.type!=="item"&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!=="item"?null:t.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}if(e=this.getKey(e),e==null)return;let t=new P(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);t.has(e)?t.delete(e):this.canSelectItem(e)&&(t.add(e),t.anchorKey=e,t.currentKey=e),!(this.disallowEmptySelection&&t.size===0)&&this.state.setSelectedKeys(t)}replaceSelection(e){if(this.selectionMode==="none"||(e=this.getKey(e),e==null))return;let t=this.canSelectItem(e)?new P([e],e,e):new P;this.state.setSelectedKeys(t)}setSelectedKeys(e){if(this.selectionMode==="none")return;let t=new P;for(let l of e)if(l=this.getKey(l),l!=null&&(t.add(l),this.selectionMode==="single"))break;this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=l=>{for(;l!=null;){if(this.canSelectItem(l)){let s=this.collection.getItem(l);s.type==="item"&&e.push(l),s.hasChildNodes&&(this.allowsCellSelection||s.type!=="item")&&t(Le(Me(s,this.collection)).key)}l=this.collection.getKeyAfter(l)}};return t(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new P)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||t&&(t.pointerType==="touch"||t.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let l of e)if(!t.has(l))return!1;for(let l of t)if(!e.has(l))return!1;return!0}canSelectItem(e){var t;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let l=this.collection.getItem(e);return!(!l||!(l==null||(t=l.props)===null||t===void 0)&&t.isDisabled||l.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var t,l;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.isDisabled))}isLink(e){var t,l;return!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.href)}getItemProps(e){var t;return(t=this.collection.getItem(e))===null||t===void 0?void 0:t.props}constructor(e,t,l){this.collection=e,this.state=t;var s;this.allowsCellSelection=(s=l==null?void 0:l.allowsCellSelection)!==null&&s!==void 0?s:!1,this._isSelectAll=null,this.layoutDelegate=(l==null?void 0:l.layoutDelegate)||null}}export{Je as $,Xe as a,Qe as b,ke as c,Ge as d,Me as e,Ye as f,Te as g,Fe as h,Ze as i,se as j,Be as k,Le as l};
