let o=new WeakMap,n=[];function b(p,c=document.body){let i=new Set(p),a=new Set,f=t=>{for(let l of t.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))i.add(l);let r=l=>{if(i.has(l)||l.parentElement&&a.has(l.parentElement)&&l.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let h of i)if(l.contains(h))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r}),E=r(t);if(E===NodeFilter.FILTER_ACCEPT&&u(t),E!==NodeFilter.FILTER_REJECT){let l=e.nextNode();for(;l!=null;)u(l),l=e.nextNode()}},u=t=>{var r;let e=(r=o.get(t))!==null&&r!==void 0?r:0;t.getAttribute("aria-hidden")==="true"&&e===0||(e===0&&t.setAttribute("aria-hidden","true"),a.add(t),o.set(t,e+1))};n.length&&n[n.length-1].disconnect(),f(c);let d=new MutationObserver(t=>{for(let r of t)if(!(r.type!=="childList"||r.addedNodes.length===0)&&![...i,...a].some(e=>e.contains(r.target))){for(let e of r.removedNodes)e instanceof Element&&(i.delete(e),a.delete(e));for(let e of r.addedNodes)(e instanceof HTMLElement||e instanceof SVGElement)&&(e.dataset.liveAnnouncer==="true"||e.dataset.reactAriaTopLayer==="true")?i.add(e):e instanceof Element&&f(e)}});d.observe(c,{childList:!0,subtree:!0});let s={observe(){d.observe(c,{childList:!0,subtree:!0})},disconnect(){d.disconnect()}};return n.push(s),()=>{d.disconnect();for(let t of a){let r=o.get(t);r!=null&&(r===1?(t.removeAttribute("aria-hidden"),o.delete(t)):o.set(t,r-1))}s===n[n.length-1]?(n.pop(),n.length&&n[n.length-1].observe()):n.splice(n.indexOf(s),1)}}export{b as $};
