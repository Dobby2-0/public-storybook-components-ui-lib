import{c as G,b as re,a as ne,d as O,e as de}from"./Collection-DBqu8l_V.js";import{n as T,c as se,e as J,d as F,q as W,B as ce,C as ue,v as fe,g as Q,D as j,f as X,s as Y,i as A,y as Z,h as be,x as pe}from"./useFocusRing-COHXKEhw.js";import{$ as ee,a as te,c as $e,d as ve,e as ge,f as ye,g as he,h as xe,i as I,j as De,k as me,l as oe}from"./DragAndDrop-Brvc0Xnm.js";import{r as d,R as $}from"./index-DRjF_FHU.js";import{$ as Pe,a as ke}from"./Text-YYl8Jarj.js";import{a as Se}from"./usePress-CEEQ2DfS.js";import{$ as Me}from"./context-NQqpI-UJ.js";import{a as Ke}from"./FocusScope-Cyqu5Mq1.js";const N=new WeakMap;function we(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function Be(o,e){let a=N.get(o);if(!a)throw new Error("Unknown list");return`${a.id}-option-${we(e)}`}function Ce(o){let{selectionManager:e,collection:a,disabledKeys:t,ref:n,keyboardDelegate:i,layoutDelegate:l}=o,r=ee({usage:"search",sensitivity:"base"}),s=e.disabledBehavior,f=d.useMemo(()=>i||new te({collection:a,disabledKeys:t,disabledBehavior:s,ref:n,collator:r,layoutDelegate:l}),[i,l,a,t,n,r,s]),{collectionProps:c}=$e({...o,ref:n,selectionManager:e,keyboardDelegate:f});return{listProps:c}}function Fe(o,e,a){let t=T(o,{labelable:!0}),n=o.selectionBehavior||"toggle",i=o.linkBehavior||(n==="replace"?"action":"override");n==="toggle"&&i==="action"&&(i="override");let{listProps:l}=Ce({...o,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:i}),{focusWithinProps:r}=se({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),s=J(o.id);N.set(e,{id:s,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:i});let{labelProps:f,fieldProps:c}=Pe({...o,id:s,labelElementType:"span"});return{labelProps:f,listBoxProps:F(t,r,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...F(c,l)})}}const q=new WeakMap;function Ee(o){let e=q.get(o);if(e!=null)return e;let a=0,t=n=>{for(let i of n)i.type==="section"?t(ve(i,o)):a++};return t(o),q.set(o,a),a}function He(o,e,a){var t,n;let{key:i}=o,l=N.get(e);var r;let s=(r=o.isDisabled)!==null&&r!==void 0?r:e.selectionManager.isDisabled(i);var f;let c=(f=o.isSelected)!==null&&f!==void 0?f:e.selectionManager.isSelected(i);var D;let p=(D=o.shouldSelectOnPressUp)!==null&&D!==void 0?D:l==null?void 0:l.shouldSelectOnPressUp;var m;let M=(m=o.shouldFocusOnHover)!==null&&m!==void 0?m:l==null?void 0:l.shouldFocusOnHover;var h;let v=(h=o.shouldUseVirtualFocus)!==null&&h!==void 0?h:l==null?void 0:l.shouldUseVirtualFocus;var b;let k=(b=o.isVirtualized)!==null&&b!==void 0?b:l==null?void 0:l.isVirtualized,y=W(),w=W(),g={role:"option","aria-disabled":s||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};ce()&&ue()||(g["aria-label"]=o["aria-label"],g["aria-labelledby"]=y,g["aria-describedby"]=w);let u=e.collection.getItem(i);if(k){let K=Number(u==null?void 0:u.index);g["aria-posinset"]=Number.isNaN(K)?void 0:K+1,g["aria-setsize"]=Ee(e.collection)}let S=l!=null&&l.onAction?()=>{var K;return l==null||(K=l.onAction)===null||K===void 0?void 0:K.call(l,i)}:void 0,{itemProps:P,isPressed:x,isFocused:B,hasAction:E,allowsSelection:z}=ge({selectionManager:e.selectionManager,key:i,ref:a,shouldSelectOnPressUp:p,allowsDifferentPressOrigin:p&&M,isVirtualized:k,shouldUseVirtualFocus:v,isDisabled:s,onAction:S||!(u==null||(t=u.props)===null||t===void 0)&&t.onAction?fe(u==null||(n=u.props)===null||n===void 0?void 0:n.onAction,S):void 0,linkBehavior:l==null?void 0:l.linkBehavior}),{hoverProps:H}=Q({isDisabled:s||!M,onHoverStart(){j()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(i))}}),C=T(u==null?void 0:u.props);delete C.id;let V=Se(u==null?void 0:u.props);return{optionProps:{...g,...F(C,P,H,V),id:Be(e,i)},labelProps:{id:y},descriptionProps:{id:w},isFocused:B,isFocusVisible:B&&j(),isSelected:c,isDisabled:s,isPressed:x,allowsSelection:z,hasAction:E}}function Ve(o){let{heading:e,"aria-label":a}=o,t=J();return{itemProps:{role:"presentation"},headingProps:e?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?t:void 0}}}class _{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let a=this.keyMap.get(e);var t;return a&&(t=a.prevKey)!==null&&t!==void 0?t:null}getKeyAfter(e){let a=this.keyMap.get(e);var t;return a&&(t=a.nextKey)!==null&&t!==void 0?t:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var a;return(a=this.keyMap.get(e))!==null&&a!==void 0?a:null}at(e){const a=[...this.getKeys()];return this.getItem(a[e])}getChildren(e){let a=this.keyMap.get(e);return(a==null?void 0:a.childNodes)||[]}constructor(e){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e;let a=l=>{if(this.keyMap.set(l.key,l),l.childNodes&&l.type==="section")for(let r of l.childNodes)a(r)};for(let l of e)a(l);let t=null,n=0;for(let[l,r]of this.keyMap)t?(t.nextKey=l,r.prevKey=t.key):(this.firstKey=l,r.prevKey=void 0),r.type==="item"&&(r.index=n++),t=r,t.nextKey=void 0;var i;this.lastKey=(i=t==null?void 0:t.key)!==null&&i!==void 0?i:null}}function Te(o){let{filter:e,layoutDelegate:a}=o,t=ye(o),n=d.useMemo(()=>o.disabledKeys?new Set(o.disabledKeys):new Set,[o.disabledKeys]),i=d.useCallback(c=>e?new _(e(c)):new _(c),[e]),l=d.useMemo(()=>({suppressTextValueWarning:o.suppressTextValueWarning}),[o.suppressTextValueWarning]),r=he(o,i,l),s=d.useMemo(()=>new xe(r,t,{layoutDelegate:a}),[r,t,a]);const f=d.useRef(null);return d.useEffect(()=>{if(t.focusedKey!=null&&!r.getItem(t.focusedKey)&&f.current){const b=f.current.getItem(t.focusedKey),k=[...f.current.getKeys()].map(P=>{const x=f.current.getItem(P);return(x==null?void 0:x.type)==="item"?x:null}).filter(P=>P!==null),y=[...r.getKeys()].map(P=>{const x=r.getItem(P);return(x==null?void 0:x.type)==="item"?x:null}).filter(P=>P!==null);var c,D;const w=((c=k==null?void 0:k.length)!==null&&c!==void 0?c:0)-((D=y==null?void 0:y.length)!==null&&D!==void 0?D:0);var p,m,M;let g=Math.min(w>1?Math.max(((p=b==null?void 0:b.index)!==null&&p!==void 0?p:0)-w+1,0):(m=b==null?void 0:b.index)!==null&&m!==void 0?m:0,((M=y==null?void 0:y.length)!==null&&M!==void 0?M:0)-1),u=null,S=!1;for(;g>=0;){if(!s.isDisabled(y[g].key)){u=y[g];break}if(g<y.length-1&&!S)g++;else{S=!0;var h,v;g>((h=b==null?void 0:b.index)!==null&&h!==void 0?h:0)&&(g=(v=b==null?void 0:b.index)!==null&&v!==void 0?v:0),g--}}t.setFocusedKey(u?u.key:null)}f.current=r},[r,s,t,t.focusedKey]),{collection:r,disabledKeys:n,selectionManager:s}}const ae=d.createContext({}),Xe=G("header",function(e,a){return[e,a]=X(e,a,ae),$.createElement("header",{className:"react-aria-Header",...e,ref:a},e.children)}),Ae=d.createContext({}),le=d.createContext(null),L=d.createContext(null);function Ie(o,e){[o,e]=X(o,e,le);let a=d.useContext(L);return a?$.createElement(ie,{state:a,props:o,listBoxRef:e}):$.createElement(re,{content:$.createElement(ne,o)},t=>$.createElement(Le,{props:o,listBoxRef:e,collection:t}))}function Le({props:o,listBoxRef:e,collection:a}){o={...o,collection:a,children:null,items:null};let{layoutDelegate:t}=d.useContext(O),n=Te({...o,layoutDelegate:t});return $.createElement(ie,{state:n,props:o,listBoxRef:e})}const Ye=d.forwardRef(Ie);function ie({state:o,props:e,listBoxRef:a}){let{dragAndDropHooks:t,layout:n="stack",orientation:i="vertical"}=e,{collection:l,selectionManager:r}=o,s=!!(t!=null&&t.useDraggableCollectionState),f=!!(t!=null&&t.useDroppableCollectionState),{direction:c}=Me(),{disabledBehavior:D,disabledKeys:p}=r,m=ee({usage:"search",sensitivity:"base"}),{isVirtualized:M,layoutDelegate:h,dropTargetDelegate:v,CollectionRoot:b}=d.useContext(O),k=d.useMemo(()=>e.keyboardDelegate||new te({collection:l,collator:m,ref:a,disabledKeys:p,disabledBehavior:D,layout:n,orientation:i,direction:c,layoutDelegate:h}),[l,m,a,D,p,i,c,e.keyboardDelegate,n,h]),{listBoxProps:y}=Fe({...e,shouldSelectOnPressUp:s||e.shouldSelectOnPressUp,keyboardDelegate:k,isVirtualized:M},o,a),w=d.useRef(s),g=d.useRef(f);d.useEffect(()=>{w.current!==s&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),g.current!==f&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[s,f]);let u,S,P,x=!1,B=null,E=d.useRef(null);if(s&&t){u=t.useDraggableCollectionState({collection:l,selectionManager:r,preview:t.renderDragPreview?E:void 0}),t.useDraggableCollection({},u,a);let U=t.DragPreview;B=t.renderDragPreview?$.createElement(U,{ref:E},t.renderDragPreview):null}if(f&&t){S=t.useDroppableCollectionState({collection:l,selectionManager:r});let U=t.dropTargetDelegate||v||new t.ListDropTargetDelegate(l,a,{orientation:i,layout:n,direction:c});P=t.useDroppableCollection({keyboardDelegate:k,dropTargetDelegate:U},S,a),x=S.isDropTarget({type:"root"})}let{focusProps:z,isFocused:H,isFocusVisible:C}=be(),V={isDropTarget:x,isEmpty:o.collection.size===0,isFocused:H,isFocusVisible:C,layout:e.layout||"stack",state:o},K=A({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:V}),R=null;return o.collection.size===0&&e.renderEmptyState&&(R=$.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(V))),$.createElement(Ke,null,$.createElement("div",{...T(e),...F(y,z,P==null?void 0:P.collectionProps),...K,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":x||void 0,"data-empty":o.collection.size===0||void 0,"data-focused":H||void 0,"data-focus-visible":C||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},$.createElement(Z,{values:[[le,e],[L,o],[I,{dragAndDropHooks:t,dragState:u,dropState:S}],[Ae,{elementType:"div"}],[De,{render:Ue}],[de,{name:"ListBoxSection",render:ze}]]},$.createElement(b,{collection:l,scrollRef:a,persistedKeys:me(r,t,S),renderDropIndicator:oe(t,S)})),R,B))}function ze(o,e,a,t="react-aria-ListBoxSection"){let n=d.useContext(L),{dragAndDropHooks:i,dropState:l}=d.useContext(I),{CollectionBranch:r}=d.useContext(O),[s,f]=pe();var c;let{headingProps:D,groupProps:p}=Ve({heading:f,"aria-label":(c=o["aria-label"])!==null&&c!==void 0?c:void 0}),m=A({defaultClassName:t,className:o.className,style:o.style,values:{}});return $.createElement("section",{...T(o),...p,...m,ref:e},$.createElement(ae.Provider,{value:{...D,ref:s}},$.createElement(r,{collection:n.collection,parent:a,renderDropIndicator:oe(i,l)})))}const Ze=G("item",function(e,a,t){let n=Y(a),i=d.useContext(L),{dragAndDropHooks:l,dragState:r,dropState:s}=d.useContext(I),{optionProps:f,labelProps:c,descriptionProps:D,...p}=He({key:t.key,"aria-label":e==null?void 0:e["aria-label"]},i,n),{hoverProps:m,isHovered:M}=Q({isDisabled:!p.allowsSelection&&!p.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),h=null;r&&l&&(h=l.useDraggableItem({key:t.key},r));let v=null;s&&l&&(v=l.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},s,n));let b=r&&r.isDragging(t.key),k=A({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...p,isHovered:M,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!r,isDragging:b,isDropTarget:v==null?void 0:v.isDropTarget}});d.useEffect(()=>{t.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[t.textValue]);let y=e.href?"a":"div";return $.createElement(y,{...F(f,m,h==null?void 0:h.dragProps,v==null?void 0:v.dropProps),...k,ref:n,"data-allows-dragging":!!r||void 0,"data-selected":p.isSelected||void 0,"data-disabled":p.isDisabled||void 0,"data-hovered":M||void 0,"data-focused":p.isFocused||void 0,"data-focus-visible":p.isFocusVisible||void 0,"data-pressed":p.isPressed||void 0,"data-dragging":b||void 0,"data-drop-target":(v==null?void 0:v.isDropTarget)||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},$.createElement(Z,{values:[[ke,{slots:{label:c,description:D}}]]},k.children))});function Ue(o,e){e=Y(e);let{dragAndDropHooks:a,dropState:t}=d.useContext(I),{dropIndicatorProps:n,isHidden:i,isDropTarget:l}=a.useDropIndicator(o,t,e);return i?null:$.createElement(Ne,{...o,dropIndicatorProps:n,isDropTarget:l,ref:e})}function Oe(o,e){let{dropIndicatorProps:a,isDropTarget:t,...n}=o,i=A({...n,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return $.createElement("div",{...a,...i,role:"option",ref:e,"data-drop-target":t||void 0})}const Ne=d.forwardRef(Oe);export{Xe as $,Ye as a,Ze as b,le as c,L as d,Te as e,N as f,Ee as g,Be as h,_ as i,Ce as j};
