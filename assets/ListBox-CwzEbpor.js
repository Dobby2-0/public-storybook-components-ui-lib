import{c as j,b as le,a as ie,d as L,e as de}from"./Collection-DRqAicu0.js";import{k as A,c as ne,e as G,d as E,p as R,C as se,D as ce,v as ue,g as J,E as W,f as Q,s as X,i as T,z as Y,h as fe,y as be}from"./useFocusRing-BDCLxdHg.js";import{$ as Z,a as ee,b as _,c as pe,d as $e,e as oe}from"./DragAndDrop-AF_Njh29.js";import{r as n,R as u}from"./index-DRjF_FHU.js";import{$ as ge,a as ve}from"./Text-EhxhI55T.js";import{a as he}from"./usePress-7HEdGBJW.js";import{d as xe,e as De,f as me}from"./SelectionManager-DIJt_wjX.js";import{$ as Pe}from"./useListState-98eh8J0v.js";import{$ as ye}from"./context-Dd3Tsyv-.js";import{b as Se}from"./FocusScope-Wo7kQ_Qj.js";const N=new WeakMap;function ke(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function Ce(o,e){let r=N.get(o);if(!r)throw new Error("Unknown list");return`${r.id}-option-${ke(e)}`}function we(o){let{selectionManager:e,collection:r,disabledKeys:t,ref:i,keyboardDelegate:l,layoutDelegate:a}=o,d=Z({usage:"search",sensitivity:"base"}),s=e.disabledBehavior,f=n.useMemo(()=>l||new ee({collection:r,disabledKeys:t,disabledBehavior:s,ref:i,collator:d,layoutDelegate:a}),[l,a,r,t,i,d,s]),{collectionProps:p}=xe({...o,ref:i,selectionManager:e,keyboardDelegate:f});return{listProps:p}}function Be(o,e,r){let t=A(o,{labelable:!0}),i=o.selectionBehavior||"toggle",l=o.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&l==="action"&&(l="override");let{listProps:a}=we({...o,ref:r,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:l}),{focusWithinProps:d}=ne({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),s=G(o.id);N.set(e,{id:s,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:l});let{labelProps:f,fieldProps:p}=ge({...o,id:s,labelElementType:"span"});return{labelProps:f,listBoxProps:E(t,d,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...E(p,a)})}}const q=new WeakMap;function Fe(o){let e=q.get(o);if(e!=null)return e;e=0;let r=t=>{for(let i of t)i.type==="section"?r(De(i,o)):e++};return r(o),q.set(o,e),e}function Ee(o,e,r){var t,i;let{key:l}=o,a=N.get(e);var d;let s=(d=o.isDisabled)!==null&&d!==void 0?d:e.selectionManager.isDisabled(l);var f;let p=(f=o.isSelected)!==null&&f!==void 0?f:e.selectionManager.isSelected(l);var v;let b=(v=o.shouldSelectOnPressUp)!==null&&v!==void 0?v:a==null?void 0:a.shouldSelectOnPressUp;var x;let S=(x=o.shouldFocusOnHover)!==null&&x!==void 0?x:a==null?void 0:a.shouldFocusOnHover;var g;let $=(g=o.shouldUseVirtualFocus)!==null&&g!==void 0?g:a==null?void 0:a.shouldUseVirtualFocus;var D;let m=(D=o.isVirtualized)!==null&&D!==void 0?D:a==null?void 0:a.isVirtualized,k=R(),H=R(),P={role:"option","aria-disabled":s||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?p:void 0};se()&&ce()||(P["aria-label"]=o["aria-label"],P["aria-labelledby"]=k,P["aria-describedby"]=H);let c=e.collection.getItem(l);if(m){let y=Number(c==null?void 0:c.index);P["aria-posinset"]=Number.isNaN(y)?void 0:y+1,P["aria-setsize"]=Fe(e.collection)}let h=a!=null&&a.onAction?()=>{var y;return a==null||(y=a.onAction)===null||y===void 0?void 0:y.call(a,l)}:void 0,{itemProps:C,isPressed:w,isFocused:B,hasAction:M,allowsSelection:z}=me({selectionManager:e.selectionManager,key:l,ref:r,shouldSelectOnPressUp:b,allowsDifferentPressOrigin:b&&S,isVirtualized:m,shouldUseVirtualFocus:$,isDisabled:s,onAction:h||!(c==null||(t=c.props)===null||t===void 0)&&t.onAction?ue(c==null||(i=c.props)===null||i===void 0?void 0:i.onAction,h):void 0,linkBehavior:a==null?void 0:a.linkBehavior}),{hoverProps:V}=J({isDisabled:s||!S,onHoverStart(){W()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(l))}}),F=A(c==null?void 0:c.props);delete F.id;let I=he(c==null?void 0:c.props);return{optionProps:{...P,...E(F,C,V,I),id:Ce(e,l)},labelProps:{id:k},descriptionProps:{id:H},isFocused:B,isFocusVisible:B&&W(),isSelected:p,isDisabled:s,isPressed:w,allowsSelection:z,hasAction:M}}function He(o){let{heading:e,"aria-label":r}=o,t=G();return{itemProps:{role:"presentation"},headingProps:e?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":r,"aria-labelledby":e?t:void 0}}}const te=n.createContext({}),Je=j("header",function(e,r){return[e,r]=Q(e,r,te),u.createElement("header",{className:"react-aria-Header",...e,ref:r},e.children)}),Me=n.createContext({}),ae=n.createContext(null),U=n.createContext(null);function Ve(o,e){[o,e]=Q(o,e,ae);let r=n.useContext(U);return r?u.createElement(re,{state:r,props:o,listBoxRef:e}):u.createElement(le,{content:u.createElement(ie,o)},t=>u.createElement(Ie,{props:o,listBoxRef:e,collection:t}))}function Ie({props:o,listBoxRef:e,collection:r}){o={...o,collection:r,children:null,items:null};let{layoutDelegate:t}=n.useContext(L),i=Pe({...o,layoutDelegate:t});return u.createElement(re,{state:i,props:o,listBoxRef:e})}const Qe=n.forwardRef(Ve);function re({state:o,props:e,listBoxRef:r}){let{dragAndDropHooks:t,layout:i="stack",orientation:l="vertical"}=e,{collection:a,selectionManager:d}=o,s=!!(t!=null&&t.useDraggableCollectionState),f=!!(t!=null&&t.useDroppableCollectionState),{direction:p}=ye(),{disabledBehavior:v,disabledKeys:b}=d,x=Z({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:g,dropTargetDelegate:$,CollectionRoot:D}=n.useContext(L),m=n.useMemo(()=>e.keyboardDelegate||new ee({collection:a,collator:x,ref:r,disabledKeys:b,disabledBehavior:v,layout:i,orientation:l,direction:p,layoutDelegate:g}),[a,x,r,v,b,l,p,e.keyboardDelegate,i,g]),{listBoxProps:k}=Be({...e,shouldSelectOnPressUp:s||e.shouldSelectOnPressUp,keyboardDelegate:m,isVirtualized:S},o,r),H=n.useRef(s),P=n.useRef(f);n.useEffect(()=>{H.current!==s&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),P.current!==f&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[s,f]);let c,h,C,w=!1,B=null,M=n.useRef(null);if(s&&t){c=t.useDraggableCollectionState({collection:a,selectionManager:d,preview:t.renderDragPreview?M:void 0}),t.useDraggableCollection({},c,r);let O=t.DragPreview;B=t.renderDragPreview?u.createElement(O,{ref:M},t.renderDragPreview):null}if(f&&t){h=t.useDroppableCollectionState({collection:a,selectionManager:d});let O=t.dropTargetDelegate||$||new t.ListDropTargetDelegate(a,r,{orientation:l,layout:i,direction:p});C=t.useDroppableCollection({keyboardDelegate:m,dropTargetDelegate:O},h,r),w=h.isDropTarget({type:"root"})}let{focusProps:z,isFocused:V,isFocusVisible:F}=fe(),I={isDropTarget:w,isEmpty:o.collection.size===0,isFocused:V,isFocusVisible:F,layout:e.layout||"stack",state:o},y=T({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:I}),K=null;return o.collection.size===0&&e.renderEmptyState&&(K=u.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(I))),u.createElement(Se,null,u.createElement("div",{...A(e),...E(k,z,C==null?void 0:C.collectionProps),...y,ref:r,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":o.collection.size===0||void 0,"data-focused":V||void 0,"data-focus-visible":F||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},u.createElement(Y,{values:[[ae,e],[U,o],[_,{dragAndDropHooks:t,dragState:c,dropState:h}],[Me,{elementType:"div"}],[pe,{render:Te}],[de,{render:Ae}]]},u.createElement(D,{collection:a,scrollRef:r,persistedKeys:$e(d,t,h),renderDropIndicator:oe(t,h)})),K,B))}function Ae(o,e,r){let t=n.useContext(U),{dragAndDropHooks:i,dropState:l}=n.useContext(_),{CollectionBranch:a}=n.useContext(L),[d,s]=be();var f;let{headingProps:p,groupProps:v}=He({heading:s,"aria-label":(f=o["aria-label"])!==null&&f!==void 0?f:void 0}),b=T({defaultClassName:"react-aria-Section",className:o.className,style:o.style,values:{}});return u.createElement("section",{...A(o),...v,...b,ref:e},u.createElement(te.Provider,{value:{...p,ref:d}},u.createElement(a,{collection:t.collection,parent:r,renderDropIndicator:oe(i,l)})))}const Xe=j("item",function(e,r,t){let i=X(r),l=n.useContext(U),{dragAndDropHooks:a,dragState:d,dropState:s}=n.useContext(_),{optionProps:f,labelProps:p,descriptionProps:v,...b}=Ee({key:t.key,"aria-label":e==null?void 0:e["aria-label"]},l,i),{hoverProps:x,isHovered:S}=J({isDisabled:!b.allowsSelection&&!b.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),g=null;d&&a&&(g=a.useDraggableItem({key:t.key},d));let $=null;s&&a&&($=a.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},s,i));let D=d&&d.isDragging(t.key),m=T({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...b,isHovered:S,selectionMode:l.selectionManager.selectionMode,selectionBehavior:l.selectionManager.selectionBehavior,allowsDragging:!!d,isDragging:D,isDropTarget:$==null?void 0:$.isDropTarget}});n.useEffect(()=>{t.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[t.textValue]);let k=e.href?"a":"div";return u.createElement(k,{...E(f,x,g==null?void 0:g.dragProps,$==null?void 0:$.dropProps),...m,ref:i,"data-allows-dragging":!!d||void 0,"data-selected":b.isSelected||void 0,"data-disabled":b.isDisabled||void 0,"data-hovered":S||void 0,"data-focused":b.isFocused||void 0,"data-focus-visible":b.isFocusVisible||void 0,"data-pressed":b.isPressed||void 0,"data-dragging":D||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":l.selectionManager.selectionMode==="none"?void 0:l.selectionManager.selectionMode},u.createElement(Y,{values:[[ve,{slots:{label:p,description:v}}]]},m.children))});function Te(o,e){e=X(e);let{dragAndDropHooks:r,dropState:t}=n.useContext(_),{dropIndicatorProps:i,isHidden:l,isDropTarget:a}=r.useDropIndicator(o,t,e);return l?null:u.createElement(Ue,{...o,dropIndicatorProps:i,isDropTarget:a,ref:e})}function _e(o,e){let{dropIndicatorProps:r,isDropTarget:t,...i}=o,l=T({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return u.createElement("div",{...r,...l,role:"option",ref:e,"data-drop-target":t||void 0})}const Ue=n.forwardRef(_e);export{Je as $,Qe as a,Xe as b,ae as c,U as d,N as e,Fe as f,Ce as g,we as h};
